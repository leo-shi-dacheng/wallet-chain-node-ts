# wallet-chain-node-ts
wallet sdk  nodejs


# 1.中心化钱包开发

## 离线地址生成
- 调度签名机生成密钥对 签名机突出公钥
- 使用公钥导出地址

## 充值逻辑
- 获得最新快高； 更新到数据库
- 从数据库中获取上次解析交易的快高作为起始快高，最新快高为截止快高，如果数据库中没有记录，说明要重头开始解析，初始快高为0
- 解析区块里面的交易 to 地址是系统内部的用户地址， 说明用户充值， 更新交易到数据库中， 将交易的状态设置为待确认
- 所在快的交易过了确认位，将交易状态更新位 充值成功并通知业务层
- 解析到的充值交易需要在钱包的数据库里面维护 UTXO

## 提现逻辑
- 获取离线签名需要的参数，给合适的手续费
- 构建未签名的交易消息摘要，将消息摘要递给签名机签名
- 构建完整的交易并进行序列化
- 发送交易到区块链网络
- 扫链或渠道交易之后更新交易状态并上报业务层

## 归集逻辑
- 将用户地址上的自己转到归集地址
- 发送交易到区块链网络
- 扫链或去到交易之后更新交易状态

## 转冷逻辑
- 将热钱包上的资金转到冷钱包地址，签名流程类似提现
- 发送交易到区块链网络
- 扫链或去到交易之后更新交易状态

## 冷转热逻辑
- 手动操作转账到热钱包地址
- 扫链或去到交易之后更新交易状态


***

# 2.HD钱包开发
## 离线地址生成和离线签名

## 和链上交互的接口
- 获取账户余额
- 根据地址或去交易记录
- 根据tx hash 获取交易详情
- 获取未话费的输入输出
- 获取交易手续费
